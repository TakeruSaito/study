}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-2) ){
for(j in (i + 1):(length(data) - 1) ){
#      x <- abs( cor(data[,i] , data[,j]) );
x <- vif(lm(data[,i] ~ ., data[,j:(j+1)]))
print(x)
if(is.na(x[2]) || x[2] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(a)
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-1) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1)
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
print(j)
if((j+9) > length(x)){
x <- vif(lm(data[,i] ~ ., data[,j:length(x)]))
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+9)]))
}
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 9
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-1) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1);print("loop")
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
if((j+9) > length(x)){
x <- vif(lm(data[,i] ~ ., data[,j:length(x)]));print("end")
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+9)]));print("middle")
}
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 9
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(a)
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-10) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1);print("loop")
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
if(length(x) > (j + 9) ){
x <- vif(lm(data[,i] ~ ., data[,j:length(x)]));print("end")
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+9)]));print("middle")
}
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 9
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(a)
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-10) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1);print("loop")
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
if(length(data) > (j + 9) ){
x <- vif(lm(data[,i] ~ ., data[,j:length(x)]));print("end")
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+9)]));print("middle")
}
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 9
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(a)
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-10) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1);print("loop")
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
if(length(data) > (j + 9) ){
x <- vif(lm(data[,i] ~ ., data[,j:length(data)]));print("end")
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+9)]));print("middle")
}
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 9
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(a)
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-10) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1);print("loop")
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
if(length(data) < (j + 9) ){
x <- vif(lm(data[,i] ~ ., data[,j:length(data)]));print("end")
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+9)]));print("middle")
}
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 9
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(a)
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-5) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1);print("loop")
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
if(length(data) < (j + 4) ){
x <- vif(lm(data[,i] ~ ., data[,j:length(data)]));print("end")
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+4)]));print("middle")
}
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 4
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(a)
b <- a[,-1:-4]
Multico(b)
c <- lm(a[,1] ~ . , a)
c
b
summary(c)
c <- lm(a[,1] ~ . , a[,1:10])
summary(c)
a
c <- lm(b[,1] ~ ., b[,-1])
c
d <- b[,1:17]
d <- d[,-14]
d[1,]
d <- d[,-9]
Multico(d)
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-5) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1);print("loop")
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
if(length(data) < (j + 4) ){
x <- vif(lm(data[,i] ~ ., data[,j:length(data)]));print("end")
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+4)]));print("middle")
}
print(x)
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 4
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(d)
Multico <- function(AllFact){
data <- AllFact  #このAllFactは工数・規模を除いた、全調整要因
data[is.na(data)] <- 0
buffer <- data
ts<- 0
for(i in 5:length(data)){
if(sum(data[,i]) == 0){
ts <- c(ts, i)
}
}
ts <- ts[-1]
if(length(ts) != 0){
for(i in length(ts):1){
buffer <- buffer[,-ts[i]]
}
}
data <- buffer
vect <- 0
for(i in 5:(length(data)-5) ){
#    for(j in (i + 1):(length(data) - 1) ){
j <- (i + 1);print("loop")
while(j <= length(data)){
#      x <- abs( cor(data[,i] , data[,j]) );
if(length(data) < (j + 4) ){
x <- vif(lm(data[,i] ~ ., data[,j:length(data)]));print("end")
}else{
x <- vif(lm(data[,i] ~ ., data[,j:(j+4)]));print("middle")
}
print(x)
for(k in 1:length(x)){
if(is.na(x[k]) || x[k] >= 10){
vect <- rbind(vect, c(i,(j + 1)))
}
}
j <- j + 5
}
}
if(length(vect) != 0){
vname <- 0;
for(i in 2:length(vect[1,])){
data[,vect[i,2]] <- 0
}
}
for(i in length(data):5){
if(sum(data[,i]) == 0){
data <- data[,-i]
}
}
#  return (vect)
return(data)
}
Multico(d)
save.image("2015Model.RData")
